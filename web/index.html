<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dialogstöd inom ryggkirurgi – baserat på Svenska Ryggregistret Swespine</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body onLoad="initialize()">
    <div class="container">
        <div class="left-section">
            <div class="tabs" id="tabs"></div>
            <div class="tab-content" id="tab-content"></div>
        </div>
        <div class="right-section">
            <div class="tabs">
                <button class="tab-button tab-button-prediction active" data-tab="satisfaction">
                    Nöjd: <span id="tab_prediction_satisfaction"></span>
                </button>
                <button class="tab-button tab-button-prediction" data-tab="outcome">
                    Lyckat utfall: <span id="tab_prediction_outcome"></span>
                </button>
            </div>
            <div class="tab-content">
                <div id="satisfaction" class="tab-pane tab-pane-prediction active">
                    <div class="box" style="text-align: center;">
                        <div class="predictionHeader">Sannolikhet att bli nöjd med operation</div>
                        <div id="prediction_satisfaction" class="prediction"></div>
                    </div>
                    <div class="explanation-section">
                        <div class="explanationHeader">Förklaring</div>
                        <div id="featureContributions_satisfaction"></div>
                        <div style="padding-top:10px">
                            Diagrammet visar hur sannolikheten att bli nöjd med operation beräknas utifrån sannolikheten att bli nöjd för en genomsnittlig patient samt faktorer avseende vald patientprofil.
                        </div>
                        <div class="header-container" id="toggle-clickable-global-explanation-satisfaction">
                            <div class="square" id="toggle-button-global-explanation-satisfaction">+</div> Mer information</div>
                        <div id="collapsible-container-global-explanation-satisfaction" class="collapsible-container">
                            <div id="collapsible-content-global-explanation-satisfaction">
                                <div class="box" style="text-align: left;">
                                    Fråga i swespine: <ul id="swespine_question_satisfaction"></></ul>
                                    Definition: <ul id="swespine_definition_satisfaction"></ul>
                                    Modellen förutsäger nöjdhet på basis av en stor mängd data om tidigare operationsresultat från alla kliniker i Sverige under en tioårsperiod, och uppdateras varje år.
                                    Hur de olika faktorerna (ålder, kön etc.) i allmänhet påverkar beräknad nöjdhet framgår nedan.
                                    <div id="globalExplanationTable_satisfaction"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="outcome" class="tab-pane tab-pane-prediction">
                    <div class="box" style="text-align: center;">
                        <div class="predictionHeader">Sannolikhet för lyckat utfall</div>
                        <div class="predictionSubHeader">(smärtan helt försvunnen eller mycket förbättrad efter 1 år)</div>
                        <div id="prediction_outcome" class="prediction"></div>
                    </div>
                    <div id="probabilitiesPieChart_outcome"></div>
                    <div>
                        Pajdiagrammet visar sannolikheten för olika smärtnivåer efter en hypotetisk operation, baserat på vald patientprofil.
                    </div>
                    <div class="explanation-section">
                        <div class="explanationHeader">Förklaring</div>
                        <div id="featureContributions_outcome"></div>
                        <div style="padding-top:10px">
                            Diagrammet visar hur sannolikheten för lyckat utfall av operation (smärtan helt försvunnen eller mycket förbättrad efter 1 år) beräknas utifrån sannolikheten för lyckat utfall för en genomsnittlig patient samt faktorer avseende vald patientprofil.
                        </div>
                        <div class="header-container" id="toggle-clickable-global-explanation-outcome">
                            <div class="square" id="toggle-button-global-explanation-outcome">+</div> Mer information</div>
                        <div id="collapsible-container-global-explanation-outcome" class="collapsible-container">
                            <div id="collapsible-content-global-explanation-outcome">
                                <div class="box" style="text-align: left;">
                                    Fråga i swespine: <ul id="swespine_question_outcome"></></ul>
                                    Definition: <ul id="swespine_definition_outcome"></ul>
                                    Modellen förutsäger utfall på basis av en stor mängd data om tidigare operationsresultat från alla kliniker i Sverige under en tioårsperiod, och uppdateras varje år.
                                    Hur de olika faktorerna (ålder, kön etc.) i allmänhet påverkar beräknat utfall framgår nedan.
                                    <div id="globalExplanationTable_outcome"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script type="module">
        import { initializePredictionTool, getProfileValues } from "./prediction_tool.js";
        window.initialize = function() {
          initializePredictionTool();
        };
        window.getProfileValues = getProfileValues;
    </script>
    <script src="libs/plotly-2.11.1.min.js"></script>
    <script src="libs/jstat.min.js"></script>
    <script src="libs/orderedprobit.js"></script>
</body>
</html>
