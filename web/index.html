<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dialogstöd inom ryggkirurgi – baserat på Svenska Ryggregistret Swespine</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body onLoad="initialize()">
    <div class="container">
        <div class="left-section">
            <div class="tabs" id="tabs"></div>
            <div class="tab-content" id="tab-content"></div>
        </div>
        <div class="right-section">
            <div class="tabs">
                <button class="tab-button tab-button-prediction active" data-tab="satisfaction">
                    Nöjd: <span id="tab_prediction_satisfaction"></span>
                </button>
                <button class="tab-button tab-button-prediction" data-tab="outcome">
                    Lyckat utfall: <span id="tab_prediction_outcome"></span>
                </button>
            </div>
            <div class="tab-content">
                <div id="satisfaction" class="tab-pane tab-pane-prediction active">
                    <div class="box" style="text-align: center;">
                        <h2>Sannolikhet att bli nöjd med operation</h2>
                        <div id="prediction_satisfaction" class="prediction"></div>
                    </div>
                    <div id="probabilitiesPieChart_satisfaction"></div>
                    <div>
                        Pajdiagrammet visar sannolikheten att bli nöjd respektive tveksam eller missnöjd med en hypotetisk operation, baserat på vald patientprofil. Klicka på respektive pajbit för att få en förklaring till hur sannolikheten beräknas.
                    </div>
                    <div class="explanation-section">
                        <h3 class="header-container" id="toggle-clickable-global-explanation-satisfaction">
                            <div class="square" id="toggle-button-global-explanation-satisfaction">+</div> Mer information</h3>
                        <div id="collapsible-container-global-explanation-satisfaction" class="collapsible-container">
                            <div id="collapsible-content-global-explanation-satisfaction">
                                <div class="box" style="text-align: left;">
                                    Fråga i swespine: <ul id="swespine_question_satisfaction"></></ul>
                                    Definition: <ul id="swespine_definition_satisfaction"></ul>
                                    Modellen förutsäger nöjdhet på basis av en stor mängd data om tidigare operationsresultat från alla kliniker i Sverige under en tioårsperiod, och uppdateras varje år.
                                    Hur de olika faktorerna (ålder, kön etc.) i allmänhet påverkar beräknad nöjdhet framgår nedan.
                                    <div id="globalExplanationTable_satisfaction"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="outcome" class="tab-pane tab-pane-prediction">
                    <div class="box" style="text-align: center;">
                        <h2>Sannolikhet för lyckat utfall<br />
                            <span style="font-weight:normal; font-size:80%;">(smärtan helt försvunnen eller mycket förbättrad efter 1 år)</span></h2>
                        <div id="prediction_outcome" class="prediction"></div>
                    </div>
                    <div id="probabilitiesPieChart_outcome"></div>
                    <div>
                        Pajdiagrammet visar sannolikheten för olika smärtnivåer (ANPASSA BEROENDE PÅ DIAGNOS!) efter en hypotetisk operation, baserat på vald patientprofil. Klicka på respektive pajbit för att få en förklaring till hur sannolikheten beräknas.
                    </div>
                    <div class="explanation-section">
                        <h3 class="header-container" id="toggle-clickable-global-explanation-outcome">
                            <div class="square" id="toggle-button-global-explanation-outcome">+</div> Mer information</h3>
                        <div id="collapsible-container-global-explanation-outcome" class="collapsible-container">
                            <div id="collapsible-content-global-explanation-outcome">
                                <div class="box" style="text-align: left;">
                                    Fråga i swespine: <ul id="swespine_question_outcome"></></ul>
                                    Definition: <ul id="swespine_definition_outcome"></ul>
                                    Modellen förutsäger utfall på basis av en stor mängd data om tidigare operationsresultat från alla kliniker i Sverige under en tioårsperiod, och uppdateras varje år.
                                    Hur de olika faktorerna (ålder, kön etc.) i allmänhet påverkar beräknat utfall framgår nedan.
                                    <div id="globalExplanationTable_outcome"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="overlay" class="overlay"></div>
    <div id="popup" class="popup"></div>

    <script type="module">
        import { initializePredictionTool } from "./prediction_tool.js";
        window.initialize = function() {
          initializePredictionTool();
        };
    </script>
    <script src="plotly-2.11.1.min.js"></script>
    <script src="jstat.min.js"></script>
    <script src="orderedprobit.js"></script>
</body>
</html>
